<app-header [userType]="'admin'"></app-header>

<div class="shifts-management">
    <div class="container">
        <div class="page-header">
            <h1>Gest√£o de Plant√µes</h1>
            <button class="btn btn-secondary" (click)="navigateTo('/admin/dashboard')">
                Voltar ao Dashboard
            </button>
        </div>

        <div class="content-grid">
            <div class="form-section">
                <h2>Publicar Novo Plant√£o</h2>
                <form (ngSubmit)="publishShift()" class="shift-form">
                    <div class="form-group">
                        <label for="hospital">Hospital</label>
                        <input type="text" id="hospital" [(ngModel)]="newShift.hospital" name="hospital"
                            placeholder="Nome do Hospital" required />
                    </div>

                    <div class="form-group">
                        <label for="date">Data</label>
                        <input type="date" id="date" [(ngModel)]="newShift.date" name="date" required />
                    </div>

                    <div class="form-group">
                        <label for="time">Hor√°rio</label>
                        <input type="time" id="time" [(ngModel)]="newShift.time" name="time" required />
                    </div>

                    <div class="form-group">
                        <label for="specialty">Especialidade</label>
                        <select id="specialty" [(ngModel)]="newShift.specialty" name="specialty" required>
                            <option value="">Selecione uma especialidade</option>
                            <option value="Cardiologia">Cardiologia</option>
                            <option value="Pediatria">Pediatria</option>
                            <option value="Ortopedia">Ortopedia</option>
                            <option value="Emerg√™ncia">Emerg√™ncia</option>
                            <option value="Cl√≠nica Geral">Cl√≠nica Geral</option>
                            <option value="Cirurgia">Cirurgia</option>
                            <option value="Neurologia">Neurologia</option>
                            <option value="Ginecologia">Ginecologia</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="value">Valor (R$)</label>
                        <input type="number" id="value" [(ngModel)]="newShift.value" name="value" placeholder="1000"
                            min="0" step="50" required />
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">
                        Publicar Plant√£o
                    </button>
                </form>
            </div>

            <div class="list-section">
                <h2>Plant√µes Publicados</h2>

                <div class="filters">
                    <button class="filter-btn" [class.active]="filter === 'all'" (click)="setFilter('all')">
                        Todos ({{ shifts.length }})
                    </button>
                    <button class="filter-btn" [class.active]="filter === 'open'" (click)="setFilter('open')">
                        Abertos ({{ getOpenCount() }})
                    </button>
                    <button class="filter-btn" [class.active]="filter === 'filled'" (click)="setFilter('filled')">
                        Preenchidos ({{ getFilledCount() }})
                    </button>
                </div>

                <div class="shifts-list">
                    <div class="shift-card" *ngFor="let shift of getFilteredShifts()">
                        <div class="shift-header">
                            <h3>{{ shift.hospital }}</h3>
                            <span [class]="'status-badge status-' + shift.status">
                                {{ shift.status === 'open' ? 'Aberto' : 'Preenchido' }}
                            </span>
                        </div>
                        <div class="shift-details">
                            <div class="detail-row">
                                <span class="detail-label">üìÖ Data/Hora:</span>
                                <span>{{ formatDate(shift.date) }} {{ shift.time }}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">üè• Especialidade:</span>
                                <span>{{ shift.specialty }}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">üí∞ Valor:</span>
                                <span class="value">R$ {{ shift.value }}</span>
                            </div>
                            <div class="detail-row" *ngIf="shift.assignedDoctor">
                                <span class="detail-label">üë®‚Äç‚öïÔ∏è M√©dico:</span>
                                <span>{{ shift.assignedDoctor }}</span>
                            </div>
                        </div>
                        <div class="shift-actions">
                            <button class="btn btn-secondary btn-small" (click)="deleteShift(shift.id)">
                                Remover
                            </button>
                        </div>
                    </div>

                    <div class="empty-state" *ngIf="getFilteredShifts().length === 0">
                        <p>Nenhum plant√£o encontrado</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>